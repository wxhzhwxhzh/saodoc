"use strict";(globalThis.webpackChunksaodoc=globalThis.webpackChunksaodoc||[]).push([[3972],{6494:(n,o,e)=>{e.r(o),e.d(o,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"js/intro2","title":"\ud83d\udd35 \u51fd\u6570Hook","description":"1. \u51fd\u6570Hook\uff08\u62e6\u622a\u51fd\u6570\u8c03\u7528\uff09","source":"@site/docs/js/2.hook.md","sourceDirName":"js","slug":"/js/intro2","permalink":"/saodoc/docs/js/intro2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/js/2.hook.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"intro2","permalink":"/js/hook","title":"\ud83d\udd35 \u51fd\u6570Hook"},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udd35 \u9f20\u6807\u8f68\u8ff9\u4ee3\u7801","permalink":"/saodoc/docs/js/intro1"},"next":{"title":"\ud83d\udd35 Promise","permalink":"/saodoc/docs/js/intro3"}}');var r=e(4848),l=e(8453);const a={id:"intro2",permalink:"/js/hook",title:"\ud83d\udd35 \u51fd\u6570Hook"},s=void 0,i={},c=[{value:"1. \u51fd\u6570Hook\uff08\u62e6\u622a\u51fd\u6570\u8c03\u7528\uff09",id:"1-\u51fd\u6570hook\u62e6\u622a\u51fd\u6570\u8c03\u7528",level:2},{value:"\u57fa\u7840\u51fd\u6570Hook",id:"\u57fa\u7840\u51fd\u6570hook",level:3},{value:"\u901a\u7528\u51fd\u6570Hook\u5de5\u5177",id:"\u901a\u7528\u51fd\u6570hook\u5de5\u5177",level:3},{value:"2. \u5c5e\u6027Hook\uff08Proxy\u62e6\u622a\uff09",id:"2-\u5c5e\u6027hookproxy\u62e6\u622a",level:2},{value:"\u4f7f\u7528Proxy\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027",id:"\u4f7f\u7528proxy\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027",level:3},{value:"Hook\u7279\u5b9a\u5c5e\u6027\uff08\u5982localStorage\uff09",id:"hook\u7279\u5b9a\u5c5e\u6027\u5982localstorage",level:3},{value:"3. \u7f51\u7edc\u8bf7\u6c42Hook",id:"3-\u7f51\u7edc\u8bf7\u6c42hook",level:2},{value:"XMLHttpRequest Hook",id:"xmlhttprequest-hook",level:3},{value:"Fetch API Hook",id:"fetch-api-hook",level:3},{value:"4. \u8c03\u8bd5\u5668\u68c0\u6d4b\u7ed5\u8fc7Hook",id:"4-\u8c03\u8bd5\u5668\u68c0\u6d4b\u7ed5\u8fc7hook",level:2},{value:"\u7ed5\u8fc7debugger\u68c0\u6d4b",id:"\u7ed5\u8fc7debugger\u68c0\u6d4b",level:3},{value:"\u7ed5\u8fc7console\u68c0\u6d4b",id:"\u7ed5\u8fc7console\u68c0\u6d4b",level:3},{value:"5. \u52a0\u5bc6\u51fd\u6570Hook",id:"5-\u52a0\u5bc6\u51fd\u6570hook",level:2},{value:"Hook\u5e38\u89c1\u7684\u52a0\u5bc6\u5e93",id:"hook\u5e38\u89c1\u7684\u52a0\u5bc6\u5e93",level:3},{value:"6. \u65f6\u95f4\u51fd\u6570Hook",id:"6-\u65f6\u95f4\u51fd\u6570hook",level:2},{value:"Hook Date\u548c\u5b9a\u65f6\u5668",id:"hook-date\u548c\u5b9a\u65f6\u5668",level:3},{value:"7. DOM\u64cd\u4f5cHook",id:"7-dom\u64cd\u4f5chook",level:2},{value:"Hook DOM\u65b9\u6cd5",id:"hook-dom\u65b9\u6cd5",level:3},{value:"8. \u901a\u7528Hook\u6846\u67b6",id:"8-\u901a\u7528hook\u6846\u67b6",level:2},{value:"\u5b8c\u6574\u7684Hook\u5de5\u5177\u7c7b",id:"\u5b8c\u6574\u7684hook\u5de5\u5177\u7c7b",level:3},{value:"\u4f7f\u7528\u6ce8\u610f\u4e8b\u9879\uff1a",id:"\u4f7f\u7528\u6ce8\u610f\u4e8b\u9879",level:2}];function d(n){const o={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.h2,{id:"1-\u51fd\u6570hook\u62e6\u622a\u51fd\u6570\u8c03\u7528",children:"1. \u51fd\u6570Hook\uff08\u62e6\u622a\u51fd\u6570\u8c03\u7528\uff09"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"\u5728JavaScript\u9006\u5411\u8fc7\u7a0b\u4e2d\uff0c\u5e38\u89c1\u7684Hook\u6280\u672f\u4e3b\u8981\u7528\u4e8e\u62e6\u622a\u3001\u76d1\u63a7\u548c\u4fee\u6539\u51fd\u6570\u8c03\u7528\u3001\u5c5e\u6027\u8bbf\u95ee\u3001\u7f51\u7edc\u8bf7\u6c42\u7b49\u884c\u4e3a\u3002\u4ee5\u4e0b\u662f\u51e0\u79cd\u5e38\u7528\u7684Hook\u4ee3\u7801\uff1a"}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:"\u57fa\u7840\u51fd\u6570hook",children:"\u57fa\u7840\u51fd\u6570Hook"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook\u5355\u4e2a\u51fd\u6570\nconst originalFunction = targetObject.targetFunction;\ntargetObject.targetFunction = function(...args) {\n    console.log('\u51fd\u6570\u8c03\u7528:', args);\n    \n    // \u5728\u51fd\u6570\u6267\u884c\u524d\u7684\u64cd\u4f5c\n    const result = originalFunction.apply(this, args);\n    \n    // \u5728\u51fd\u6570\u6267\u884c\u540e\u7684\u64cd\u4f5c\n    console.log('\u51fd\u6570\u8fd4\u56de:', result);\n    return result;\n};\n"})}),"\n",(0,r.jsx)(o.h3,{id:"\u901a\u7528\u51fd\u6570hook\u5de5\u5177",children:"\u901a\u7528\u51fd\u6570Hook\u5de5\u5177"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"function hookFunction(obj, funcName, beforeCallback, afterCallback) {\n    const originalFunc = obj[funcName];\n    obj[funcName] = function(...args) {\n        if (beforeCallback) {\n            beforeCallback.call(this, args);\n        }\n        const result = originalFunc.apply(this, args);\n        if (afterCallback) {\n            afterCallback.call(this, args, result);\n        }\n        return result;\n    };\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nhookFunction(console, 'log', (args) => {\n    console.log('\u5373\u5c06\u8f93\u51fa:', args);\n}, (args, result) => {\n    console.log('\u5df2\u8f93\u51fa:', args);\n});\n"})}),"\n",(0,r.jsx)(o.h2,{id:"2-\u5c5e\u6027hookproxy\u62e6\u622a",children:"2. \u5c5e\u6027Hook\uff08Proxy\u62e6\u622a\uff09"}),"\n",(0,r.jsx)(o.h3,{id:"\u4f7f\u7528proxy\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027",children:"\u4f7f\u7528Proxy\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook\u6574\u4e2a\u5bf9\u8c61\nfunction hookObject(obj) {\n    return new Proxy(obj, {\n        get(target, prop, receiver) {\n            console.log(`\u8bbf\u95ee\u5c5e\u6027: ${prop.toString()}`);\n            return Reflect.get(target, prop, receiver);\n        },\n        set(target, prop, value, receiver) {\n            console.log(`\u8bbe\u7f6e\u5c5e\u6027: ${prop.toString()} = ${value}`);\n            return Reflect.set(target, prop, value, receiver);\n        },\n        apply(target, thisArg, args) {\n            console.log(`\u51fd\u6570\u8c03\u7528: ${target.name}`, args);\n            return Reflect.apply(target, thisArg, args);\n        }\n    });\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nconst hookedWindow = hookObject(window);\n"})}),"\n",(0,r.jsx)(o.h3,{id:"hook\u7279\u5b9a\u5c5e\u6027\u5982localstorage",children:"Hook\u7279\u5b9a\u5c5e\u6027\uff08\u5982localStorage\uff09"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook localStorage\nconst originalSetItem = localStorage.setItem;\nlocalStorage.setItem = function(key, value) {\n    console.log(`localStorage\u8bbe\u7f6e: ${key} = ${value}`);\n    return originalSetItem.call(this, key, value);\n};\n\nconst originalGetItem = localStorage.getItem;\nlocalStorage.getItem = function(key) {\n    const value = originalGetItem.call(this, key);\n    console.log(`localStorage\u83b7\u53d6: ${key} = ${value}`);\n    return value;\n};\n"})}),"\n",(0,r.jsx)(o.h2,{id:"3-\u7f51\u7edc\u8bf7\u6c42hook",children:"3. \u7f51\u7edc\u8bf7\u6c42Hook"}),"\n",(0,r.jsx)(o.h3,{id:"xmlhttprequest-hook",children:"XMLHttpRequest Hook"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook XMLHttpRequest\nconst originalOpen = XMLHttpRequest.prototype.open;\nconst originalSend = XMLHttpRequest.prototype.send;\n\nXMLHttpRequest.prototype.open = function(method, url, ...args) {\n    this._url = url;\n    this._method = method;\n    return originalOpen.call(this, method, url, ...args);\n};\n\nXMLHttpRequest.prototype.send = function(body) {\n    console.log('XHR\u8bf7\u6c42:', {\n        method: this._method,\n        url: this._url,\n        body: body\n    });\n    \n    // \u76d1\u542c\u54cd\u5e94\n    this.addEventListener('load', function() {\n        console.log('XHR\u54cd\u5e94:', {\n            url: this._url,\n            status: this.status,\n            response: this.responseText\n        });\n    });\n    \n    return originalSend.call(this, body);\n};\n"})}),"\n",(0,r.jsx)(o.h3,{id:"fetch-api-hook",children:"Fetch API Hook"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook fetch\nconst originalFetch = window.fetch;\nwindow.fetch = function(...args) {\n    const [url, options = {}] = args;\n    console.log('Fetch\u8bf7\u6c42:', { url, options });\n    \n    return originalFetch.apply(this, args).then(response => {\n        const clonedResponse = response.clone();\n        clonedResponse.text().then(text => {\n            console.log('Fetch\u54cd\u5e94:', { url, response: text });\n        });\n        return response;\n    });\n};\n"})}),"\n",(0,r.jsx)(o.h2,{id:"4-\u8c03\u8bd5\u5668\u68c0\u6d4b\u7ed5\u8fc7hook",children:"4. \u8c03\u8bd5\u5668\u68c0\u6d4b\u7ed5\u8fc7Hook"}),"\n",(0,r.jsx)(o.h3,{id:"\u7ed5\u8fc7debugger\u68c0\u6d4b",children:"\u7ed5\u8fc7debugger\u68c0\u6d4b"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// \u7981\u7528debugger\u8bed\u53e5\nwindow.addEventListener('load', function() {\n    // \u65b9\u6cd51: \u91cd\u5199debugger\n    const originalEval = eval;\n    window.eval = function(code) {\n        if (code === 'debugger') return;\n        return originalEval(code);\n    };\n    \n    // \u65b9\u6cd52: \u4f7f\u7528Proxy\u62e6\u622a\n    const script = document.createElement('script');\n    const originalAppendChild = document.head.appendChild;\n    document.head.appendChild = function(node) {\n        if (node instanceof HTMLScriptElement) {\n            node.textContent = node.textContent.replace(/debugger;/g, '');\n        }\n        return originalAppendChild.call(this, node);\n    };\n});\n"})}),"\n",(0,r.jsx)(o.h3,{id:"\u7ed5\u8fc7console\u68c0\u6d4b",children:"\u7ed5\u8fc7console\u68c0\u6d4b"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook console\u9632\u6b62\u68c0\u6d4b\nconst originalLog = console.log;\nconsole.log = function(...args) {\n    // \u53ef\u4ee5\u9009\u62e9\u6027\u5730\u5c4f\u853d\u67d0\u4e9b\u65e5\u5fd7\n    if (!args.some(arg => typeof arg === 'string' && arg.includes('debug'))) {\n        originalLog.apply(console, args);\n    }\n};\n"})}),"\n",(0,r.jsx)(o.h2,{id:"5-\u52a0\u5bc6\u51fd\u6570hook",children:"5. \u52a0\u5bc6\u51fd\u6570Hook"}),"\n",(0,r.jsx)(o.h3,{id:"hook\u5e38\u89c1\u7684\u52a0\u5bc6\u5e93",children:"Hook\u5e38\u89c1\u7684\u52a0\u5bc6\u5e93"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook CryptoJS\nif (window.CryptoJS) {\n    const originalAES = CryptoJS.AES.encrypt;\n    CryptoJS.AES.encrypt = function(message, key, cfg) {\n        console.log('AES\u52a0\u5bc6:', { message, key, cfg });\n        const result = originalAES.call(this, message, key, cfg);\n        console.log('AES\u7ed3\u679c:', result.toString());\n        return result;\n    };\n}\n\n// Hook Web Crypto API\nif (window.crypto && window.crypto.subtle) {\n    const originalEncrypt = crypto.subtle.encrypt;\n    crypto.subtle.encrypt = function(algorithm, key, data) {\n        console.log('Web Crypto\u52a0\u5bc6:', { algorithm, key, data });\n        return originalEncrypt.call(this, algorithm, key, data);\n    };\n}\n"})}),"\n",(0,r.jsx)(o.h2,{id:"6-\u65f6\u95f4\u51fd\u6570hook",children:"6. \u65f6\u95f4\u51fd\u6570Hook"}),"\n",(0,r.jsx)(o.h3,{id:"hook-date\u548c\u5b9a\u65f6\u5668",children:"Hook Date\u548c\u5b9a\u65f6\u5668"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook Date\u6784\u9020\u51fd\u6570\nconst originalDate = Date;\nwindow.Date = function(...args) {\n    if (args.length === 0) {\n        console.log('\u83b7\u53d6\u5f53\u524d\u65f6\u95f4');\n    }\n    return new originalDate(...args);\n};\nDate.prototype = originalDate.prototype;\n\n// Hook setTimeout/setInterval\nconst originalSetTimeout = setTimeout;\nwindow.setTimeout = function(callback, delay, ...args) {\n    console.log('\u8bbe\u7f6e\u5b9a\u65f6\u5668:', { callback, delay, args });\n    return originalSetTimeout.call(this, callback, delay, ...args);\n};\n"})}),"\n",(0,r.jsx)(o.h2,{id:"7-dom\u64cd\u4f5chook",children:"7. DOM\u64cd\u4f5cHook"}),"\n",(0,r.jsx)(o.h3,{id:"hook-dom\u65b9\u6cd5",children:"Hook DOM\u65b9\u6cd5"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"// Hook createElement\nconst originalCreateElement = document.createElement;\ndocument.createElement = function(tagName, options) {\n    console.log('\u521b\u5efa\u5143\u7d20:', tagName);\n    const element = originalCreateElement.call(this, tagName, options);\n    return element;\n};\n\n// Hook appendChild\nconst originalAppendChild = Element.prototype.appendChild;\nElement.prototype.appendChild = function(child) {\n    console.log('\u6dfb\u52a0\u5b50\u5143\u7d20:', child);\n    return originalAppendChild.call(this, child);\n};\n"})}),"\n",(0,r.jsx)(o.h2,{id:"8-\u901a\u7528hook\u6846\u67b6",children:"8. \u901a\u7528Hook\u6846\u67b6"}),"\n",(0,r.jsx)(o.h3,{id:"\u5b8c\u6574\u7684hook\u5de5\u5177\u7c7b",children:"\u5b8c\u6574\u7684Hook\u5de5\u5177\u7c7b"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",children:"class HookManager {\n    static hookFunction(obj, funcName, options = {}) {\n        const originalFunc = obj[funcName];\n        if (!originalFunc) return;\n        \n        obj[funcName] = function(...args) {\n            if (options.before) options.before.call(this, args);\n            try {\n                const result = originalFunc.apply(this, args);\n                if (options.after) options.after.call(this, args, result);\n                return result;\n            } catch (error) {\n                if (options.onError) options.onError.call(this, error, args);\n                throw error;\n            }\n        };\n    }\n    \n    static hookProperty(obj, propName, options = {}) {\n        let value = obj[propName];\n        \n        Object.defineProperty(obj, propName, {\n            get() {\n                if (options.onGet) options.onGet(value);\n                return value;\n            },\n            set(newValue) {\n                if (options.onSet) options.onSet(newValue, value);\n                value = newValue;\n            },\n            configurable: true,\n            enumerable: true\n        });\n    }\n    \n    static hookAllMethods(obj, exclude = []) {\n        Object.getOwnPropertyNames(obj).forEach(prop => {\n            if (exclude.includes(prop)) return;\n            if (typeof obj[prop] === 'function') {\n                this.hookFunction(obj, prop, {\n                    before: (args) => console.log(`${prop} called with:`, args)\n                });\n            }\n        });\n    }\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nHookManager.hookFunction(window, 'alert', {\n    before: (args) => console.log('Alert\u88ab\u8c03\u7528:', args[0])\n});\n\nHookManager.hookProperty(navigator, 'userAgent', {\n    onGet: (value) => console.log('\u8bfb\u53d6userAgent:', value)\n});\n"})}),"\n",(0,r.jsx)(o.h2,{id:"\u4f7f\u7528\u6ce8\u610f\u4e8b\u9879",children:"\u4f7f\u7528\u6ce8\u610f\u4e8b\u9879\uff1a"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"\u6267\u884c\u65f6\u673a"}),"\uff1aHook\u4ee3\u7801\u9700\u8981\u5728\u76ee\u6807\u51fd\u6570/\u5bf9\u8c61\u88ab\u4f7f\u7528\u4e4b\u524d\u6267\u884c"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"\u4f5c\u7528\u57df\u95ee\u9898"}),"\uff1a\u6ce8\u610f",(0,r.jsx)(o.code,{children:"this"}),"\u6307\u5411\u548c\u4f5c\u7528\u57df\u94fe"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"\u6027\u80fd\u5f71\u54cd"}),"\uff1a\u5927\u91cfHook\u53ef\u80fd\u5f71\u54cd\u9875\u9762\u6027\u80fd"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"\u53cdHook\u68c0\u6d4b"}),"\uff1a\u6709\u4e9b\u7f51\u7ad9\u4f1a\u68c0\u6d4bHook\u884c\u4e3a\uff0c\u9700\u8981\u66f4\u9690\u853d\u7684\u5b9e\u73b0\u65b9\u5f0f"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"\u517c\u5bb9\u6027"}),"\uff1a\u786e\u4fddHook\u4ee3\u7801\u5728\u76ee\u6807\u73af\u5883\u4e2d\u80fd\u591f\u6b63\u5e38\u8fd0\u884c"]}),"\n"]})]})}function u(n={}){const{wrapper:o}={...(0,l.R)(),...n.components};return o?(0,r.jsx)(o,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},8453:(n,o,e)=>{e.d(o,{R:()=>a,x:()=>s});var t=e(6540);const r={},l=t.createContext(r);function a(n){const o=t.useContext(l);return t.useMemo(function(){return"function"==typeof n?n(o):{...o,...n}},[o,n])}function s(n){let o;return o=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),t.createElement(l.Provider,{value:o},n.children)}}}]);